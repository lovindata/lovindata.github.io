
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="../../../03/17/image-super-resolution-dat-dual-aggregation-transformer-the-new-goat-for-pythonistas-/">
      
      
      <link rel="icon" href="../../../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Master Scala Rest APIs in 3 Simple Concepts: Illustrated Guide with Tapir, http4s, and Circe! - LovinData - Simplified Full Stack Data Engineering</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-ZZ86YMNTY8"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-ZZ86YMNTY8",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-ZZ86YMNTY8",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
   <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#why-tapir-http4s-circe" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="LovinData - Simplified Full Stack Data Engineering" class="md-header__button md-logo" aria-label="LovinData - Simplified Full Stack Data Engineering" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LovinData - Simplified Full Stack Data Engineering
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Master Scala Rest APIs in 3 Simple Concepts: Illustrated Guide with Tapir, http4s, and Circe!
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label=""  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label=""  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  Latest posts

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../archive/2025/" class="md-tabs__link">
          
  
  Archive

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../category/backend/" class="md-tabs__link">
          
  
  Categories

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="LovinData - Simplified Full Stack Data Engineering" class="md-nav__button md-logo" aria-label="LovinData - Simplified Full Stack Data Engineering" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    LovinData - Simplified Full Stack Data Engineering
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Latest posts
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2025/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2025
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/backend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/crowdsec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CrowdSec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/data-engineering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Engineering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/devops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DevOps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/frontend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frontend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nginx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/scala/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scala
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/traefik/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Traefik
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/typescript/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TypeScript
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-tapir-http4s-circe" class="md-nav__link">
    <span class="md-ellipsis">
      😎 Why Tapir, http4s, Circe?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#our-backend-castle" class="md-nav__link">
    <span class="md-ellipsis">
      🏰 Our Backend Castle!
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🏰 Our Backend Castle!">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backend-electricity-setup" class="md-nav__link">
    <span class="md-ellipsis">
      ⚡ Backend Electricity Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#first-bridge-endpoint" class="md-nav__link">
    <span class="md-ellipsis">
      🌉 First Bridge Endpoint!
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mastering-circe-tapir" class="md-nav__link">
    <span class="md-ellipsis">
      🎨 Mastering Circe &amp; Tapir
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎨 Mastering Circe & Tapir">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#auto-derivation-magic" class="md-nav__link">
    <span class="md-ellipsis">
      ✨ Auto Derivation Magic!
    </span>
  </a>
  
    <nav class="md-nav" aria-label="✨ Auto Derivation Magic!">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theory" class="md-nav__link">
    <span class="md-ellipsis">
      Theory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practice" class="md-nav__link">
    <span class="md-ellipsis">
      Practice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      Results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crack-adts" class="md-nav__link">
    <span class="md-ellipsis">
      🧙‍♂️ Crack ADTs!
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧙‍♂️ Crack ADTs!">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#theory_1" class="md-nav__link">
    <span class="md-ellipsis">
      Theory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practice_1" class="md-nav__link">
    <span class="md-ellipsis">
      Practice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#results_1" class="md-nav__link">
    <span class="md-ellipsis">
      Results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#happy-endings" class="md-nav__link">
    <span class="md-ellipsis">
      🌟 Happy Endings!
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../.." class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2024-02-21 00:00:00+00:00" class="md-ellipsis">February 21, 2024</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
                          <span class="md-ellipsis">
                            in
                            
                              <a href="../../../../category/scala/">Scala</a>, 
                              <a href="../../../../category/backend/">Backend</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              16 min read
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        


  <h1>Master Scala Rest APIs in 3 Simple Concepts: Illustrated Guide with Tapir, http4s, and Circe!</h1>

<p>What if I told you there's a game-changing Scala solution for building Rest APIs and generating SwaggerUI docs at lightning speed? Plus, it's as fast as FastAPI (for Python enthusiasts) to develop! All this while preserving the robust type safety and functional programming elegance of Scala! 😲 In this post, we'll dive deep into this exhilarating tech stack: Tapir, http4s, and Circe!</p>
<!-- more -->

<p><a class="glightbox" href="../../../../0/image.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Tech stack" src="../../../../0/image.png" /></a></p>
<h2 id="why-tapir-http4s-circe">😎 Why Tapir, http4s, Circe?</h2>
<p>Let's check out what is each library:</p>
<ul>
<li>Tapir: A powerful Scala library for defining and documenting HTTP APIs in a type-safe and functional manner, with built-in support for generating Swagger UI documentation.</li>
<li>http4s: A lightweight, purely functional Scala library for building HTTP servers and clients, designed for high performance and composability.</li>
<li>Circe: A popular JSON library for Scala that provides seamless JSON parsing and encoding using a powerful and idiomatic functional approach.</li>
</ul>
<figure>
  <a class="glightbox" href="../../../../0/image-1.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Handling Requests" src="../../../../0/image-1.png" /></a>
  <figcaption>Handling Requests</figcaption>
</figure>
<p>As of now, in the Scala ecosystem, there are no actively maintained, production-ready alternatives to Tapir. However, alternatives to http4s include Play and Akka/Pekko Http, with Play being more a full-stack web framework. For JSON handling, alternatives to Circe include json4s, ZIO-json, and Play JSON. According to the <a href="https://scalasurvey2023.virtuslab.com/">2023 Scala survey</a>, it appears that the community is leaning towards the Typelevel ecosystem when it comes to building backend systems. You can also check library comparison websites like <a href="https://scala.libhunt.com/">LibHunt</a> for further insights.</p>
<figure>
  <a class="glightbox" href="../../../../0/image-2.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Akka/Pekko ecosystem VS Typelevel ecosystem" src="../../../../0/image-2.png" /></a>
  <figcaption>Akka/Pekko ecosystem VS Typelevel ecosystem</figcaption>
</figure>
<p>Either way, all these alternatives are production-ready and actively maintained. You cannot go wrong with choosing any of them.</p>
<p>For this series, the complete code is available on GitHub 🫡 at <a href="https://github.com/lovindata/blog/tree/main/assets/posts/0/backend">https://github.com/lovindata/blog/tree/main/assets/posts/0/backend</a>.</p>
<h2 id="our-backend-castle">🏰 Our Backend Castle!</h2>
<p>Setting up a Scala project is essential, and in our case, we'll do it using IntelliJ. However, you can also opt for VSCode with Metals. If it is your first time setting up a Scala project, you can follow Scala's official tutorial <a href="https://docs.scala-lang.org/getting-started/intellij-track/getting-started-with-scala-in-intellij.html">"Getting Started with Scala in IntelliJ"</a>. The folder structure should be as follows:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>backend/
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>├── project/
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>│   ├── build.properties
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>│   └── plugins.sbt
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>├── src/
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>│   └── main/
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>│       ├── resources/
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>│       └── scala/
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>│           └── Main.scala
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>└── build.sbt
</span></code></pre></div>
<p>In your <code>build.sbt</code>, please add the following dependencies:</p>
<div class="language-scala highlight"><span class="filename">build.sbt</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="cm">/**</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="cm"> * Project configurations.</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="cm"> */</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="nc">ThisBuild</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">scalaVersion</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;2.13.12&quot;</span><span class="w"> </span><span class="c1">// https://www.scala-lang.org/download/all.html</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="k">lazy</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">project</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">file</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">))</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">  </span><span class="p">.</span><span class="n">settings</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;backend&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">idePackagePrefix</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nc">Some</span><span class="p">(</span><span class="s">&quot;com.lovindata&quot;</span><span class="p">),</span><span class="w"> </span><span class="nc">Defaults</span><span class="p">.</span><span class="n">itSettings</span><span class="p">)</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">  </span><span class="p">.</span><span class="n">configs</span><span class="p">(</span><span class="nc">IntegrationTest</span><span class="p">)</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="cm">/**</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="cm"> * Dev dependencies.</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="cm"> */</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="hll"><span class="c1">// Cats &amp; Scala extensions</span>
</span></span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/org.typelevel/cats-effect</span>
</span></span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;org.typelevel&quot;</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;cats-effect&quot;</span><span class="w">        </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;3.5.3&quot;</span>
</span></span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="hll"><span class="c1">// https://github.com/oleg-py/better-monadic-for (look tags for version)</span>
</span></span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="hll"><span class="n">addCompilerPlugin</span><span class="p">(</span><span class="s">&quot;com.olegpy&quot;</span><span class="w">         </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;better-monadic-for&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;0.3.1&quot;</span><span class="p">)</span>
</span></span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/dev.optics/monocle-core</span>
</span></span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;dev.optics&quot;</span><span class="w">    </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;monocle-core&quot;</span><span class="w">       </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;3.2.0&quot;</span>
</span></span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="hll"><span class="c1">// Tapir</span>
</span></span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/com.softwaremill.sttp.tapir/tapir-http4s-server</span>
</span></span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;com.softwaremill.sttp.tapir&quot;</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;tapir-http4s-server&quot;</span><span class="w">     </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;1.9.10&quot;</span>
</span></span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/com.softwaremill.sttp.tapir/tapir-json-circe</span>
</span></span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;com.softwaremill.sttp.tapir&quot;</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;tapir-json-circe&quot;</span><span class="w">        </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;1.9.10&quot;</span>
</span></span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/com.softwaremill.sttp.tapir/tapir-swagger-ui-bundle</span>
</span></span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;com.softwaremill.sttp.tapir&quot;</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;tapir-swagger-ui-bundle&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;1.9.10&quot;</span>
</span></span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="hll"><span class="c1">// Http4s</span>
</span></span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/org.http4s/http4s-ember-server</span>
</span></span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;org.http4s&quot;</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;http4s-ember-server&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;0.23.25&quot;</span>
</span></span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/org.http4s/http4s-circe</span>
</span></span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;org.http4s&quot;</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;http4s-circe&quot;</span><span class="w">        </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;0.23.25&quot;</span>
</span></span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/org.http4s/http4s-dsl</span>
</span></span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;org.http4s&quot;</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;http4s-dsl&quot;</span><span class="w">          </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;0.23.25&quot;</span>
</span></span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/org.http4s/http4s-ember-client</span>
</span></span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;org.http4s&quot;</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;http4s-ember-client&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;0.23.25&quot;</span>
</span></span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="hll"><span class="c1">// Circe</span>
</span></span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/io.circe/circe-parser</span>
</span></span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;io.circe&quot;</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;circe-parser&quot;</span><span class="w">         </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;0.14.6&quot;</span>
</span></span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/io.circe/circe-generic</span>
</span></span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;io.circe&quot;</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;circe-generic&quot;</span><span class="w">        </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;0.14.6&quot;</span>
</span></span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/io.circe/circe-generic-extras</span>
</span></span><span id="__span-1-44"><a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;io.circe&quot;</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;circe-generic-extras&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;0.14.3&quot;</span>
</span></span><span id="__span-1-45"><a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a><span class="hll"><span class="c1">// https://mvnrepository.com/artifact/io.circe/circe-literal</span>
</span></span><span id="__span-1-46"><a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a><span class="hll"><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;io.circe&quot;</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="s">&quot;circe-literal&quot;</span><span class="w">        </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;0.14.6&quot;</span>
</span></span></code></pre></div>
<p>You can run <code>Main.scala</code> by clicking on <code>▷</code> and selecting <code>Run 'Main'</code>. If it works, you are all set! 🥳</p>
<h3 id="backend-electricity-setup">⚡ Backend Electricity Setup</h3>
<p>Let's build our first electric central that will empower the future bridges. A REST API server enables clients to interact with resources over HTTP using standard methods.</p>
<figure>
  <a class="glightbox" href="../../../../0/image-3.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Backend Server Configuration" src="../../../../0/image-3.png" /></a>
  <figcaption>Backend Server Configuration</figcaption>
</figure>
<p>First setup our service which loads environment variables and our backend exceptions:</p>
<div class="language-scala highlight"><span class="filename">EnvLoaderConf.scala</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">package</span><span class="w"> </span><span class="n">config</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="k">object</span><span class="w"> </span><span class="nc">EnvLoaderConf</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">allEnvVar</span><span class="p">:</span><span class="w"> </span><span class="nc">Map</span><span class="p">[</span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="nc">String</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">env</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">  </span><span class="kd">val</span><span class="w"> </span><span class="n">backendPort</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allEnvVar</span><span class="p">.</span><span class="n">getOrElse</span><span class="p">(</span><span class="s">&quot;BACKEND_PORT&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;8080&quot;</span><span class="p">).</span><span class="n">toInt</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-scala highlight"><span class="filename">BackendException.scala</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">package</span><span class="w"> </span><span class="n">shared</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="k">sealed</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="nc">BackendException</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">Exception</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="k">object</span><span class="w"> </span><span class="nc">BackendException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">BadRequestException</span><span class="p">(</span><span class="n">message</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">)</span><span class="w">          </span><span class="k">extends</span><span class="w"> </span><span class="nc">BackendException</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ServerInternalErrorException</span><span class="p">(</span><span class="n">message</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">)</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">BackendException</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="p">}</span>
</span></code></pre></div>
<p>Second setup our backend server:</p>
<div class="language-scala highlight"><span class="filename">BackendServerConf.scala</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">package</span><span class="w"> </span><span class="n">config</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="nc">IO</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">comcast</span><span class="p">.</span><span class="nn">ip4s</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nn">ember</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nc">EmberServerBuilder</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nn">middleware</span><span class="p">.</span><span class="nc">CORS</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="k">import</span><span class="w"> </span><span class="nn">shared</span><span class="p">.</span><span class="nc">BackendException</span><span class="p">.</span><span class="nc">ServerInternalErrorException</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="k">object</span><span class="w"> </span><span class="nc">BackendServerConf</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">:</span><span class="w"> </span><span class="nc">IO</span><span class="p">[</span><span class="nc">Unit</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">    </span><span class="n">port</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">fromOption</span><span class="p">(</span><span class="nc">Port</span><span class="p">.</span><span class="n">fromInt</span><span class="p">(</span><span class="n">envLoaderConf</span><span class="p">.</span><span class="n">backendPort</span><span class="p">))(</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">              </span><span class="nc">ServerInternalErrorException</span><span class="p">(</span><span class="s">s&quot;Not processable port number </span><span class="si">${</span><span class="n">envLoaderConf</span><span class="p">.</span><span class="n">backendPort</span><span class="si">}</span><span class="s">.&quot;</span><span class="p">))</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">    </span><span class="n">_</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">EmberServerBuilder</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">              </span><span class="p">.</span><span class="n">default</span><span class="p">[</span><span class="nc">IO</span><span class="p">]</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">              </span><span class="p">.</span><span class="n">withHost</span><span class="p">(</span><span class="n">ipv4</span><span class="s">&quot;0.0.0.0&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// Accept connections from any available network interface</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">              </span><span class="p">.</span><span class="n">withPort</span><span class="p">(</span><span class="n">port</span><span class="p">)</span><span class="w">          </span><span class="c1">// On port 8080</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">              </span><span class="p">.</span><span class="n">build</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="w">              </span><span class="p">.</span><span class="n">use</span><span class="p">(</span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">never</span><span class="p">)</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="w">              </span><span class="p">.</span><span class="n">start</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="w">              </span><span class="p">.</span><span class="n">void</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="p">()</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="p">}</span>
</span></code></pre></div>
<p>Let's finally build the switch to turn on the electricity! 💡</p>
<div class="language-scala highlight"><span class="filename">Main.scala</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">config</span><span class="p">.</span><span class="nc">BackendServerConf</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="k">object</span><span class="w"> </span><span class="nc">Main</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">IOApp</span><span class="p">.</span><span class="nc">Simple</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">  </span><span class="k">override</span><span class="w"> </span><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">:</span><span class="w"> </span><span class="nc">IO</span><span class="p">[</span><span class="nc">Unit</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">BackendServerConf</span><span class="p">.</span><span class="n">start</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">never</span><span class="w"> </span><span class="c1">// == non-terminating</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="p">}</span>
</span></code></pre></div>
<p>If you visit <a href="http://localhost:8080">http://localhost:8080</a> and see the message <code>Not found</code>, then congratulations! You've built your electric central! 🥳</p>
<h3 id="first-bridge-endpoint">🌉 First Bridge Endpoint!</h3>
<p>It's now the exciting part because we are gonna connect to the external world with bridges! 🤩 Endpoints are the specific URLs or routes in a web API that clients use to access and interact with resources or services.</p>
<figure>
  <a class="glightbox" href="../../../../0/image-4.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Backend Endpoint" src="../../../../0/image-4.png" /></a>
  <figcaption>Backend Endpoint</figcaption>
</figure>
<p>First, implement the business logic, which in our case involves counting the number of characters from a text.</p>
<div class="language-scala highlight"><span class="filename">TextSvc.scala</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="k">package</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="n">text</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="nc">IO</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">implicits</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="k">object</span><span class="w"> </span><span class="nc">TextSvc</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">countCharacters</span><span class="p">(</span><span class="n">text</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">):</span><span class="w"> </span><span class="nc">IO</span><span class="p">[</span><span class="nc">Int</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">text</span><span class="p">.</span><span class="n">length</span><span class="p">.</span><span class="n">pure</span><span class="p">[</span><span class="nc">IO</span><span class="p">]</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="p">}</span>
</span></code></pre></div>
<p>Second, build the bridge! 🌉⚒️</p>
<div class="language-scala highlight"><span class="filename">TextCtrl.scala</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="k">package</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="n">text</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="nc">IO</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nc">HttpRoutes</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">json</span><span class="p">.</span><span class="nn">circe</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nc">Http4sServerInterpreter</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="k">object</span><span class="w"> </span><span class="nc">TextCtrl</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">endpoints</span><span class="p">:</span><span class="w"> </span><span class="nc">List</span><span class="p">[</span><span class="nc">AnyEndpoint</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">(</span><span class="n">countCharactersEpt</span><span class="p">)</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">routes</span><span class="p">:</span><span class="w"> </span><span class="nc">HttpRoutes</span><span class="p">[</span><span class="nc">IO</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">countCharactersRts</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">countCharactersEpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">endpoint</span><span class="w"> </span><span class="c1">// The endpoint and it is used to generate the OpenAPI doc</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">    </span><span class="p">.</span><span class="n">summary</span><span class="p">(</span><span class="s">&quot;Count characters&quot;</span><span class="p">)</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">    </span><span class="p">.</span><span class="n">get</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="p">(</span><span class="s">&quot;count-characters&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">query</span><span class="p">[</span><span class="nc">String</span><span class="p">](</span><span class="s">&quot;text&quot;</span><span class="p">))</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="w">    </span><span class="p">.</span><span class="n">out</span><span class="p">(</span><span class="n">jsonBody</span><span class="p">[</span><span class="nc">Int</span><span class="p">])</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">countCharactersRts</span><span class="w"> </span><span class="o">=</span><span class="w">          </span><span class="c1">// It converts the endpoint to actual http4s route :O</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="w">    </span><span class="nc">Http4sServerInterpreter</span><span class="p">[</span><span class="nc">IO</span><span class="p">]().</span><span class="n">toRoutes</span><span class="p">(</span><span class="n">countCharactersEpt</span><span class="p">.</span><span class="n">serverLogicSuccess</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nc">TextSvc</span><span class="p">.</span><span class="n">countCharacters</span><span class="p">(</span><span class="n">text</span><span class="p">)))</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="p">}</span>
</span></code></pre></div>
<p>Lastly, connect our new, fresh 🌉 bridge to our electrical central ⚡️—you know, the one we built in the previous part. 🤗</p>
<div class="language-scala highlight"><span class="filename">BackendServerConf.scala</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">package</span><span class="w"> </span><span class="n">config</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="nc">IO</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">implicits</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">comcast</span><span class="p">.</span><span class="nn">ip4s</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">text</span><span class="p">.</span><span class="nc">TextCtrl</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nn">ember</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nc">EmberServerBuilder</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nn">implicits</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="k">import</span><span class="w"> </span><span class="nn">shared</span><span class="p">.</span><span class="nc">BackendException</span><span class="p">.</span><span class="nc">ServerInternalErrorException</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nc">Http4sServerInterpreter</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">swagger</span><span class="p">.</span><span class="nn">bundle</span><span class="p">.</span><span class="nc">SwaggerInterpreter</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="k">object</span><span class="w"> </span><span class="nc">BackendServerConf</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">:</span><span class="w"> </span><span class="nc">IO</span><span class="p">[</span><span class="nc">Unit</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">    </span><span class="n">port</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">fromOption</span><span class="p">(</span><span class="nc">Port</span><span class="p">.</span><span class="n">fromInt</span><span class="p">(</span><span class="nc">EnvLoaderConf</span><span class="p">.</span><span class="n">backendPort</span><span class="p">))(</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">              </span><span class="nc">ServerInternalErrorException</span><span class="p">(</span><span class="s">s&quot;Not processable port number </span><span class="si">${</span><span class="nc">EnvLoaderConf</span><span class="p">.</span><span class="n">backendPort</span><span class="si">}</span><span class="s">.&quot;</span><span class="p">))</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">    </span><span class="n">_</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">EmberServerBuilder</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">              </span><span class="p">.</span><span class="n">default</span><span class="p">[</span><span class="nc">IO</span><span class="p">]</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">              </span><span class="p">.</span><span class="n">withHost</span><span class="p">(</span><span class="n">ipv4</span><span class="s">&quot;0.0.0.0&quot;</span><span class="p">)</span><span class="w">        </span><span class="c1">// Accept connections from any available network interface</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">              </span><span class="p">.</span><span class="n">withPort</span><span class="p">(</span><span class="n">port</span><span class="p">)</span><span class="w">                 </span><span class="c1">// On port 8080</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="hll"><span class="w">              </span><span class="p">.</span><span class="n">withHttpApp</span><span class="p">(</span><span class="n">allRts</span><span class="p">.</span><span class="n">orNotFound</span><span class="p">)</span><span class="w"> </span><span class="c1">// Link all routes to the backend server</span>
</span></span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="w">              </span><span class="p">.</span><span class="n">build</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="w">              </span><span class="p">.</span><span class="n">use</span><span class="p">(</span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">never</span><span class="p">)</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="w">              </span><span class="p">.</span><span class="n">start</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="w">              </span><span class="p">.</span><span class="n">void</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="p">()</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="hll"><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">docsEpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">// Merge all endpoints as a fully usable OpenAPI doc</span>
</span></span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="hll"><span class="w">    </span><span class="nc">SwaggerInterpreter</span><span class="p">().</span><span class="n">fromEndpoints</span><span class="p">[</span><span class="nc">IO</span><span class="p">](</span><span class="nc">TextCtrl</span><span class="p">.</span><span class="n">endpoints</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Backend&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span><span class="p">)</span>
</span></span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="hll"><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">allRts</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="c1">// Serve the OpenAPI doc &amp; all the other routes</span>
</span></span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a><span class="hll"><span class="w">    </span><span class="nc">Http4sServerInterpreter</span><span class="p">[</span><span class="nc">IO</span><span class="p">]().</span><span class="n">toRoutes</span><span class="p">(</span><span class="n">docsEpt</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;+&gt;</span><span class="w"> </span><span class="nc">TextCtrl</span><span class="p">.</span><span class="n">routes</span>
</span></span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a><span class="p">}</span>
</span></code></pre></div>
<p>If you visit <a href="http://localhost:8080/docs">http://localhost:8080/docs</a> and end up on a SwaggerUI page, then congratulations! You've built your first bridge! 🥳 You can play a little bit with your endpoint! 😄</p>
<figure>
  <a class="glightbox" href="../../../../0/image-5.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="SwaggerUI" src="../../../../0/image-5.png" /></a>
  <figcaption>SwaggerUI</figcaption>
</figure>
<h2 id="mastering-circe-tapir">🎨 Mastering Circe &amp; Tapir</h2>
<p><a href="https://en.wikipedia.org/wiki/JSON">JSON</a> is the go-to format when it comes to friendly chats between clients and servers. For example, imagine a frontend <a href="https://en.wikipedia.org/wiki/Single-page_application">Single Page Application (SPA)</a> running on a user's laptop communicating with a backend <a href="https://en.wikipedia.org/wiki/REST">RestAPI</a>. In this article, let's dive into the joy of decoding JSON data from the outside world into Scala classes, or encoding Scala classes into JSON to share with the world. 🌐✨</p>
<figure>
  <a class="glightbox" href="../../../../0/image-1.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Handling Requests" src="../../../../0/image-1.png" /></a>
  <figcaption>Handling Requests</figcaption>
</figure>
<h3 id="auto-derivation-magic">✨ Auto Derivation Magic!</h3>
<h4 id="theory">Theory</h4>
<p>"✨ Auto Derivation Magic!" is the technique used to effortlessly convert JSON to Scala case classes or vice versa, leveraging the <strong>attributes of the case classes as JSON fields</strong>. For instance, consider the following JSON object:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="p">{</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="hll"><span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span></span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="hll"><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;James&quot;</span><span class="p">,</span>
</span></span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="hll"><span class="w">  </span><span class="nt">&quot;gender&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;male&quot;</span><span class="p">,</span>
</span></span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="hll"><span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">26</span><span class="p">,</span>
</span></span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="hll"><span class="w">  </span><span class="nt">&quot;job&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;software engineer&quot;</span>
</span></span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="p">}</span>
</span></code></pre></div>
<p>The corresponding Scala case class, utilizing auto-derivation, would look like:</p>
<div class="language-scala highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nc">GuestMod</span><span class="p">.</span><span class="nc">GenderEnum</span><span class="p">.</span><span class="nc">Gender</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">GuestMod</span><span class="p">(</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="hll"><span class="w">    </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="nc">Long</span><span class="p">,</span>
</span></span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="hll"><span class="w">    </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span>
</span></span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="hll"><span class="w">    </span><span class="n">gender</span><span class="p">:</span><span class="w"> </span><span class="nc">Gender</span><span class="p">,</span>
</span></span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="hll"><span class="w">    </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">,</span>
</span></span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="hll"><span class="w">    </span><span class="n">job</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span>
</span></span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="p">)</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="k">object</span><span class="w"> </span><span class="nc">GuestMod</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">  </span><span class="k">object</span><span class="w"> </span><span class="nc">GenderEnum</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">Enumeration</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="nc">Gender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Value</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nc">Male</span><span class="p">:</span><span class="w"> </span><span class="nc">Value</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nc">Value</span><span class="p">(</span><span class="s">&quot;male&quot;</span><span class="p">)</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nc">Female</span><span class="p">:</span><span class="w"> </span><span class="nc">Value</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nc">Value</span><span class="p">(</span><span class="s">&quot;female&quot;</span><span class="p">)</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nc">NonBinary</span><span class="p">:</span><span class="w"> </span><span class="nc">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Value</span><span class="p">(</span><span class="s">&quot;non-binary&quot;</span><span class="p">)</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="p">}</span>
</span></code></pre></div>
<p>As you can see, it's all about leveraging <strong>"the case class attributes as JSON fields"</strong>. Importantly, to enable auto-derivation, you'll need to have <strong>an instance object of <code>io.circe.generic.AutoDerivation</code> and <code>sttp.tapir.generic.auto.SchemaDerivation</code> imported into scope</strong>. But don't worry, we'll delve into this in the practical part.</p>
<h4 id="practice">Practice</h4>
<figure>
  <a class="glightbox" href="../../../../0/image-9.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="✨ Auto derivation in action!" src="../../../../0/image-9.png" /></a>
  <figcaption>✨ Auto derivation in action!</figcaption>
</figure>
<p>First, let's define the classes and methods required:</p>
<div class="language-scala highlight"><span class="filename">GuestMod.scala</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="k">package</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="n">guest</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nc">GuestMod</span><span class="p">.</span><span class="nc">GenderEnum</span><span class="p">.</span><span class="nc">Gender</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nn">dto</span><span class="p">.</span><span class="nc">GuestDto</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">GuestMod</span><span class="p">(</span><span class="w"> </span><span class="c1">// Returned by the endpoints == &quot;Scala -&gt; JSON&quot; (also corresponds to an entity in table)</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">    </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="nc">Long</span><span class="p">,</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">    </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">    </span><span class="n">gender</span><span class="p">:</span><span class="w"> </span><span class="nc">Gender</span><span class="p">,</span><span class="w">  </span><span class="c1">// A non Scala simple type that needs to be derived manually! (JSON &lt;-&gt; Scala)</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">    </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">,</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">    </span><span class="n">job</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">)</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="k">object</span><span class="w"> </span><span class="nc">GuestMod</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">buildFromDto</span><span class="p">(</span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="nc">Long</span><span class="p">,</span><span class="w"> </span><span class="n">dto</span><span class="p">:</span><span class="w"> </span><span class="nc">GuestDto</span><span class="p">):</span><span class="w"> </span><span class="nc">GuestMod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">GuestMod</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">job</span><span class="p">)</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="w">  </span><span class="k">object</span><span class="w"> </span><span class="nc">GenderEnum</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">Enumeration</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="nc">Gender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Value</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nc">Male</span><span class="p">:</span><span class="w"> </span><span class="nc">Value</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nc">Value</span><span class="p">(</span><span class="s">&quot;male&quot;</span><span class="p">)</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nc">Female</span><span class="p">:</span><span class="w"> </span><span class="nc">Value</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nc">Value</span><span class="p">(</span><span class="s">&quot;female&quot;</span><span class="p">)</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nc">NonBinary</span><span class="p">:</span><span class="w"> </span><span class="nc">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Value</span><span class="p">(</span><span class="s">&quot;non-binary&quot;</span><span class="p">)</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-scala highlight"><span class="filename">GuestDto.scala</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="k">package</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="n">dto</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nc">GuestMod</span><span class="p">.</span><span class="nc">GenderEnum</span><span class="p">.</span><span class="nc">Gender</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">GuestDto</span><span class="p">(</span><span class="w"> </span><span class="c1">// It corresponds to the input of the endpoint (JSON -&gt; Scala)</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">    </span><span class="n">gender</span><span class="p">:</span><span class="w"> </span><span class="nc">Gender</span><span class="p">,</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">    </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">,</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">    </span><span class="n">job</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">)</span>
</span></code></pre></div>
<p>Secondly, the shortest but most crucial step! ⚠️ <strong>By importing this <code>Serializers</code> object into scope, it implies that all case classes will be convertible between "JSON ↔ Scala". 🤯</strong></p>
<div class="language-scala highlight"><span class="filename">Serializers.scala</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="k">package</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="n">shared</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nc">GuestMod</span><span class="p">.</span><span class="nc">GenderEnum</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nc">GuestMod</span><span class="p">.</span><span class="nc">GenderEnum</span><span class="p">.</span><span class="nc">Gender</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">io</span><span class="p">.</span><span class="nn">circe</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="hll"><span class="k">import</span><span class="w"> </span><span class="nn">io</span><span class="p">.</span><span class="nn">circe</span><span class="p">.</span><span class="nn">generic</span><span class="p">.</span><span class="nc">AutoDerivation</span>
</span></span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nc">Schema</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="hll"><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">generic</span><span class="p">.</span><span class="nn">auto</span><span class="p">.</span><span class="nc">SchemaDerivation</span>
</span></span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="hll"><span class="k">object</span><span class="w"> </span><span class="nc">Serializers</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">AutoDerivation</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">SchemaDerivation</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// HERE! ✨ Auto Derivation Magic!</span>
</span></span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">  </span><span class="c1">// Enumeration needs to be auto derived manually with theses 3 lines 👇 (It will use enumeration actual values when (en/de)coding)</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="w">  </span><span class="k">implicit</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">genderEnc</span><span class="p">:</span><span class="w"> </span><span class="nc">Encoder</span><span class="p">[</span><span class="nc">Gender</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Encoder</span><span class="p">.</span><span class="n">encodeEnumeration</span><span class="p">(</span><span class="nc">GenderEnum</span><span class="p">)</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="w">  </span><span class="k">implicit</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">genderDec</span><span class="p">:</span><span class="w"> </span><span class="nc">Decoder</span><span class="p">[</span><span class="nc">Gender</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Decoder</span><span class="p">.</span><span class="n">decodeEnumeration</span><span class="p">(</span><span class="nc">GenderEnum</span><span class="p">)</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="w">  </span><span class="k">implicit</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">genderSch</span><span class="p">:</span><span class="w"> </span><span class="nc">Schema</span><span class="p">[</span><span class="nc">Gender</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nc">Schema</span><span class="p">.</span><span class="n">derivedEnumerationValue</span><span class="p">[</span><span class="nc">Gender</span><span class="p">]</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="p">}</span>
</span></code></pre></div>
<p>Thirdly, let's address the repository responsible for managing the <code>GuestMod</code> table and the associated business logic:</p>
<div class="language-scala highlight"><span class="filename">GuestRep.scala</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="k">package</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="n">guest</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="nn">unsafe</span><span class="p">.</span><span class="nn">implicits</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nn">dto</span><span class="p">.</span><span class="nc">GuestDto</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="k">object</span><span class="w"> </span><span class="nc">GuestRep</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// This layer is not important. It&#39;s an in-memory table for the example to work.</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="n">dto</span><span class="p">:</span><span class="w"> </span><span class="nc">GuestDto</span><span class="p">):</span><span class="w"> </span><span class="nc">IO</span><span class="p">[</span><span class="nc">GuestMod</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guestsTable</span><span class="p">.</span><span class="n">modify</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="o">=&gt;</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="n">id</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">table</span><span class="p">.</span><span class="n">length</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="n">guest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">GuestMod</span><span class="p">.</span><span class="n">buildFromDto</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">dto</span><span class="p">)</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="w">    </span><span class="p">(</span><span class="n">table</span><span class="w"> </span><span class="o">:+</span><span class="w"> </span><span class="n">guest</span><span class="p">,</span><span class="w"> </span><span class="n">guest</span><span class="p">)</span><span class="w"> </span><span class="c1">// (Updated table, Returned class)</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">list</span><span class="p">():</span><span class="w"> </span><span class="nc">IO</span><span class="p">[</span><span class="nc">Vector</span><span class="p">[</span><span class="nc">GuestMod</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guestsTable</span><span class="p">.</span><span class="n">get</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">guestsTable</span><span class="p">:</span><span class="w"> </span><span class="nc">Ref</span><span class="p">[</span><span class="nc">IO</span><span class="p">,</span><span class="w"> </span><span class="nc">Vector</span><span class="p">[</span><span class="nc">GuestMod</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="w">    </span><span class="nc">Ref</span><span class="p">[</span><span class="nc">IO</span><span class="p">].</span><span class="n">of</span><span class="p">(</span><span class="nc">Vector</span><span class="p">.</span><span class="n">empty</span><span class="p">[</span><span class="nc">GuestMod</span><span class="p">]).</span><span class="n">unsafeRunSync</span><span class="p">()</span><span class="w"> </span><span class="c1">// A concurrent safe in memory table</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-scala highlight"><span class="filename">GuestSvc.scala</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="k">package</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="n">guest</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="nc">IO</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nn">dto</span><span class="p">.</span><span class="nc">GuestDto</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">shared</span><span class="p">.</span><span class="nc">BackendException</span><span class="p">.</span><span class="nc">BadRequestException</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="k">object</span><span class="w"> </span><span class="nc">GuestSvc</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">letEnterAdultGuest</span><span class="p">(</span><span class="n">dto</span><span class="p">:</span><span class="w"> </span><span class="nc">GuestDto</span><span class="p">):</span><span class="w"> </span><span class="nc">IO</span><span class="p">[</span><span class="nc">GuestMod</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="hll"><span class="w">    </span><span class="n">_</span><span class="w">     </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">raiseUnless</span><span class="p">(</span><span class="n">dto</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">18</span><span class="p">)(</span>
</span></span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="hll"><span class="w">               </span><span class="nc">BadRequestException</span><span class="p">(</span><span class="s">&quot;You are not an adult!&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// Exception of &quot;BadRequestException&quot; raised</span>
</span></span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="hll"><span class="w">             </span><span class="p">)</span>
</span></span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">    </span><span class="n">guest</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">GuestRep</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">dto</span><span class="p">)</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="n">guest</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">listGuests</span><span class="p">():</span><span class="w"> </span><span class="nc">IO</span><span class="p">[</span><span class="nc">Vector</span><span class="p">[</span><span class="nc">GuestMod</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">GuestRep</span><span class="p">.</span><span class="n">list</span><span class="p">()</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="p">}</span>
</span></code></pre></div>
<p>Fourth, let's define our 🌉 bridges (endpoints) that will allow guests to enter the castle 🏰 and monitor their activities ("see ya, personal privacy" 👀😈).</p>
<div class="language-scala highlight"><span class="filename">GuestCtrl.scala</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="k">package</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="n">guest</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="nc">IO</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">implicits</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nn">dto</span><span class="p">.</span><span class="nc">GuestDto</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="hll"><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">shared</span><span class="p">.</span><span class="nc">Serializers</span><span class="p">.</span><span class="n">_</span><span class="w"> </span><span class="c1">// ✨ Auto Derivation Magic imported in scope! (== Make Scala case classes &quot;JSON ↔ Scala&quot; convertible)</span>
</span></span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nc">HttpRoutes</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="k">import</span><span class="w"> </span><span class="nn">shared</span><span class="p">.</span><span class="nc">BackendException</span><span class="p">.</span><span class="nc">BadRequestException</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">model</span><span class="p">.</span><span class="nc">StatusCode</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">json</span><span class="p">.</span><span class="nn">circe</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nc">Http4sServerInterpreter</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="k">object</span><span class="w"> </span><span class="nc">GuestCtrl</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">endpoints</span><span class="p">:</span><span class="w"> </span><span class="nc">List</span><span class="p">[</span><span class="nc">AnyEndpoint</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">(</span><span class="n">letEnterAdultGuestEpt</span><span class="p">,</span><span class="w"> </span><span class="n">listGuestsEpt</span><span class="p">)</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">routes</span><span class="p">:</span><span class="w"> </span><span class="nc">HttpRoutes</span><span class="p">[</span><span class="nc">IO</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">letEnterAdultGuestRts</span><span class="w"> </span><span class="o">&lt;+&gt;</span><span class="w"> </span><span class="n">listGuestsRts</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">letEnterAdultGuestEpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">endpoint</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="w">    </span><span class="p">.</span><span class="n">summary</span><span class="p">(</span><span class="s">&quot;Let enter adult guest&quot;</span><span class="p">)</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="w">    </span><span class="p">.</span><span class="n">post</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="p">(</span><span class="s">&quot;guests&quot;</span><span class="p">)</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="hll"><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="p">(</span><span class="n">jsonBody</span><span class="p">[</span><span class="nc">GuestDto</span><span class="p">])</span><span class="w">                 </span><span class="c1">// ✨ Auto Derivation Magic applied! (Not just simple type but case class this time)</span>
</span></span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="hll"><span class="w">    </span><span class="p">.</span><span class="n">out</span><span class="p">(</span><span class="n">jsonBody</span><span class="p">[</span><span class="nc">GuestMod</span><span class="p">])</span><span class="w">                </span><span class="c1">// ✨ Auto Derivation Magic applied!</span>
</span></span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="hll"><span class="w">    </span><span class="p">.</span><span class="n">errorOut</span><span class="p">(</span>
</span></span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="w">      </span><span class="n">statusCode</span><span class="p">(</span><span class="nc">StatusCode</span><span class="p">.</span><span class="nc">BadRequest</span><span class="p">)</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">and</span><span class="p">(</span><span class="n">jsonBody</span><span class="p">[</span><span class="nc">BadRequestException</span><span class="p">])</span><span class="w"> </span><span class="c1">// This endpoint can throw errors + ✨ Auto Derivation Magic applied!</span>
</span></span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">letEnterAdultGuestRts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Http4sServerInterpreter</span><span class="p">[</span><span class="nc">IO</span><span class="p">]().</span><span class="n">toRoutes</span><span class="p">(</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a><span class="w">    </span><span class="n">letEnterAdultGuestEpt</span>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a><span class="w">      </span><span class="p">.</span><span class="n">serverLogicRecoverErrors</span><span class="p">(</span><span class="w"> </span><span class="c1">// == recover from &quot;BadRequestException&quot; exceptions raised + Encode as JSON and return them</span>
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a><span class="w">        </span><span class="n">dto</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nc">GuestSvc</span><span class="p">.</span><span class="n">letEnterAdultGuest</span><span class="p">(</span><span class="n">dto</span><span class="p">)))</span>
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">listGuestsEpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">endpoint</span>
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a><span class="w">    </span><span class="p">.</span><span class="n">summary</span><span class="p">(</span><span class="s">&quot;List guests&quot;</span><span class="p">)</span>
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a><span class="w">    </span><span class="p">.</span><span class="n">get</span>
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="p">(</span><span class="s">&quot;guests&quot;</span><span class="p">)</span>
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a><span class="w">    </span><span class="p">.</span><span class="n">out</span><span class="p">(</span>
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a><span class="w">      </span><span class="n">jsonBody</span><span class="p">[</span>
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a><span class="w">        </span><span class="nc">Vector</span><span class="p">[</span>
</span><span id="__span-16-41"><a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a><span class="hll"><span class="w">          </span><span class="nc">GuestMod</span><span class="w"> </span><span class="c1">// /!\ Vector of Scala case class derivable is also derivable == ✨ Auto Derivation Magic applied!</span>
</span></span><span id="__span-16-42"><a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a><span class="w">        </span><span class="p">]</span>
</span><span id="__span-16-43"><a id="__codelineno-16-43" name="__codelineno-16-43" href="#__codelineno-16-43"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-16-44"><a id="__codelineno-16-44" name="__codelineno-16-44" href="#__codelineno-16-44"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-16-45"><a id="__codelineno-16-45" name="__codelineno-16-45" href="#__codelineno-16-45"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">listGuestsRts</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-16-46"><a id="__codelineno-16-46" name="__codelineno-16-46" href="#__codelineno-16-46"></a><span class="w">    </span><span class="nc">Http4sServerInterpreter</span><span class="p">[</span><span class="nc">IO</span><span class="p">]().</span><span class="n">toRoutes</span><span class="p">(</span><span class="n">listGuestsEpt</span><span class="p">.</span><span class="n">serverLogicSuccess</span><span class="p">(</span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nc">GuestSvc</span><span class="p">.</span><span class="n">listGuests</span><span class="p">()))</span>
</span><span id="__span-16-47"><a id="__codelineno-16-47" name="__codelineno-16-47" href="#__codelineno-16-47"></a><span class="p">}</span>
</span></code></pre></div>
<p>Finally, as done in the previous section, let's "connect the bridges to the electrical central 🌉 ↔ ⚡".</p>
<div class="language-scala highlight"><span class="filename">BackendServerConf.scala</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="k">package</span><span class="w"> </span><span class="n">config</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="nc">IO</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">implicits</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">comcast</span><span class="p">.</span><span class="nn">ip4s</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="hll"><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nc">GuestCtrl</span>
</span></span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">text</span><span class="p">.</span><span class="nc">TextCtrl</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nn">ember</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nc">EmberServerBuilder</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nn">implicits</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="k">import</span><span class="w"> </span><span class="nn">shared</span><span class="p">.</span><span class="nc">BackendException</span><span class="p">.</span><span class="nc">ServerInternalErrorException</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nc">Http4sServerInterpreter</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">swagger</span><span class="p">.</span><span class="nn">bundle</span><span class="p">.</span><span class="nc">SwaggerInterpreter</span>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="k">object</span><span class="w"> </span><span class="nc">BackendServerConf</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">:</span><span class="w"> </span><span class="nc">IO</span><span class="p">[</span><span class="nc">Unit</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a><span class="w">    </span><span class="n">port</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">fromOption</span><span class="p">(</span><span class="nc">Port</span><span class="p">.</span><span class="n">fromInt</span><span class="p">(</span><span class="nc">EnvLoaderConf</span><span class="p">.</span><span class="n">backendPort</span><span class="p">))(</span>
</span><span id="__span-17-18"><a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a><span class="w">              </span><span class="nc">ServerInternalErrorException</span><span class="p">(</span><span class="s">s&quot;Not processable port number </span><span class="si">${</span><span class="nc">EnvLoaderConf</span><span class="p">.</span><span class="n">backendPort</span><span class="si">}</span><span class="s">.&quot;</span><span class="p">))</span>
</span><span id="__span-17-19"><a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a><span class="w">    </span><span class="n">_</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">EmberServerBuilder</span>
</span><span id="__span-17-20"><a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a><span class="w">              </span><span class="p">.</span><span class="n">default</span><span class="p">[</span><span class="nc">IO</span><span class="p">]</span>
</span><span id="__span-17-21"><a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a><span class="w">              </span><span class="p">.</span><span class="n">withHost</span><span class="p">(</span><span class="n">ipv4</span><span class="s">&quot;0.0.0.0&quot;</span><span class="p">)</span><span class="w">        </span><span class="c1">// Accept connections from any available network interface</span>
</span><span id="__span-17-22"><a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a><span class="w">              </span><span class="p">.</span><span class="n">withPort</span><span class="p">(</span><span class="n">port</span><span class="p">)</span><span class="w">                 </span><span class="c1">// On port 8080</span>
</span><span id="__span-17-23"><a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a><span class="w">              </span><span class="p">.</span><span class="n">withHttpApp</span><span class="p">(</span><span class="n">allRts</span><span class="p">.</span><span class="n">orNotFound</span><span class="p">)</span><span class="w"> </span><span class="c1">// Link all routes to the backend server</span>
</span><span id="__span-17-24"><a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a><span class="w">              </span><span class="p">.</span><span class="n">build</span>
</span><span id="__span-17-25"><a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a><span class="w">              </span><span class="p">.</span><span class="n">use</span><span class="p">(</span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">never</span><span class="p">)</span>
</span><span id="__span-17-26"><a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a><span class="w">              </span><span class="p">.</span><span class="n">start</span>
</span><span id="__span-17-27"><a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a><span class="w">              </span><span class="p">.</span><span class="n">void</span>
</span><span id="__span-17-28"><a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="p">()</span>
</span><span id="__span-17-29"><a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a>
</span><span id="__span-17-30"><a id="__codelineno-17-30" name="__codelineno-17-30" href="#__codelineno-17-30"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">docsEpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">// Merge all endpoints as a fully usable OpenAPI doc</span>
</span><span id="__span-17-31"><a id="__codelineno-17-31" name="__codelineno-17-31" href="#__codelineno-17-31"></a><span class="hll"><span class="w">    </span><span class="nc">SwaggerInterpreter</span><span class="p">().</span><span class="n">fromEndpoints</span><span class="p">[</span><span class="nc">IO</span><span class="p">](</span><span class="nc">TextCtrl</span><span class="p">.</span><span class="n">endpoints</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="nc">GuestCtrl</span><span class="p">.</span><span class="n">endpoints</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Backend&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span><span class="p">)</span>
</span></span><span id="__span-17-32"><a id="__codelineno-17-32" name="__codelineno-17-32" href="#__codelineno-17-32"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">allRts</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="c1">// Serve the OpenAPI doc &amp; all the other routes</span>
</span><span id="__span-17-33"><a id="__codelineno-17-33" name="__codelineno-17-33" href="#__codelineno-17-33"></a><span class="hll"><span class="w">    </span><span class="nc">Http4sServerInterpreter</span><span class="p">[</span><span class="nc">IO</span><span class="p">]().</span><span class="n">toRoutes</span><span class="p">(</span><span class="n">docsEpt</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;+&gt;</span><span class="w"> </span><span class="nc">TextCtrl</span><span class="p">.</span><span class="n">routes</span><span class="w"> </span><span class="o">&lt;+&gt;</span><span class="w"> </span><span class="nc">GuestCtrl</span><span class="p">.</span><span class="n">routes</span>
</span></span><span id="__span-17-34"><a id="__codelineno-17-34" name="__codelineno-17-34" href="#__codelineno-17-34"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="results">Results</h4>
<p>After re-running, navigate to <a href="http://localhost:8080/docs">http://localhost:8080/docs</a> to interact with your new endpoints! 😊</p>
<figure>
  <a class="glightbox" href="../../../../0/image-6.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="New guest success" src="../../../../0/image-6.png" /></a>
  <figcaption>New guest success</figcaption>
</figure>
<figure>
  <a class="glightbox" href="../../../../0/image-7.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="New guest failed" src="../../../../0/image-7.png" /></a>
  <figcaption>New guest failed</figcaption>
</figure>
<figure>
  <a class="glightbox" href="../../../../0/image-8.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="List guests" src="../../../../0/image-8.png" /></a>
  <figcaption>List guests</figcaption>
</figure>
<h3 id="crack-adts">🧙‍♂️ Crack ADTs!</h3>
<h4 id="theory_1">Theory</h4>
<p><a href="https://en.wikipedia.org/wiki/Algebraic_data_type">Algebraic Data Types (ADTs)</a> are a way of defining data structures by combining simpler types through two main constructs: Sum Types, representing a choice between alternatives, and Product Types, representing a combination of different types.</p>
<p>Blablabla 🤪, remember that it's commonly just a sealed trait, like this for example (refer to comments if you want to understand in detail):</p>
<div class="language-scala highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">sealed</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="nc">Pet</span><span class="w"> </span><span class="c1">// It&#39;s an ADT because &quot;Product types&quot; and &quot;Sum types&quot;</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="k">object</span><span class="w"> </span><span class="nc">Pet</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Dog</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">                  </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">)</span><span class="w"> </span><span class="c1">// 👈 &quot;Product types&quot; because &quot;(String, Int)&quot; == More complex type by combining types</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">      </span><span class="k">extends</span><span class="w"> </span><span class="nc">Pet</span><span class="w"> </span><span class="c1">// &quot;Sum types&quot; because &quot;Dog != Cat != Fish != Bird but Dog + Cat + Fish + Bird = Pet&quot; == Distinct types when united define the type</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Cat</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">)</span><span class="w">  </span><span class="k">extends</span><span class="w"> </span><span class="nc">Pet</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Fish</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">)</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">Pet</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Bird</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">)</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">Pet</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="p">}</span>
</span></code></pre></div>
<p>Now, what if I tell you there's a way to apply the "✨ Auto Derivation Magic!" to sealed traits using a discriminator field? 🤯 For example, these two can be encoded or decoded from one to another:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="p">[</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="hll"><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Dog&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// ⚠️ Discriminator field</span>
</span></span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Max&quot;</span><span class="p">,</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">    </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="hll"><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Fish&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// ⚠️ Discriminator field</span>
</span></span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Poissy (← RER A 🤪, don&#39;t worry if you don&#39;t understand, Parisians will! XDD)&quot;</span><span class="p">,</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">    </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="hll"><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Dog&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// ⚠️ Discriminator field</span>
</span></span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Doggy&quot;</span><span class="p">,</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="w">    </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="p">]</span>
</span></code></pre></div>
<div class="language-scala highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kd">val</span><span class="w"> </span><span class="n">pets</span><span class="p">:</span><span class="w"> </span><span class="nc">Vector</span><span class="p">[</span><span class="nc">Pet</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Vector</span><span class="p">(</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">  </span><span class="nc">Dog</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Max&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">  </span><span class="nc">Fish</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Poissy (← RER A \uD83E\uDD2A, don&#39;t worry if you don&#39;t understand, Parisians will! XDD)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">  </span><span class="nc">Dog</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Doggy&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="p">)</span>
</span></code></pre></div>
<p>For this to work, only two things needed:</p>
<ul>
<li><strong>An instance object of <code>io.circe.generic.extras.AutoDerivation</code> and <code>sttp.tapir.generic.auto.SchemaDerivation</code> imported into scope</strong> (⚠️ switch <code>io.circe.generic.AutoDerivation</code> to <code>io.circe.generic.extras.AutoDerivation</code>)</li>
<li>Additionally, <strong>two implicit variables of <code>io.circe.generic.extras.Configuration</code> and <code>sttp.tapir.generic.Configuration</code> imported into scope</strong> (for the discriminator field)</li>
</ul>
<p>Bear with me 🙏, you will understand in the practice part 👍!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, I recommend always opting for the ADT configuration mentioned above. This is because the ADT configuration supports both standalone case classes and case classes with sealed traits, covering our previous use case seamlessly and providing support for ADTs for free.</p>
</div>
<h4 id="practice_1">Practice</h4>
<figure>
  <a class="glightbox" href="../../../../0/image-10.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="ADT decoded and encoded (Pet contest)" src="../../../../0/image-10.png" /></a>
  <figcaption>ADT decoded and encoded (Pet contest)</figcaption>
</figure>
<p>First, let's define the sealed trait and the necessary business logic:</p>
<div class="language-scala highlight"><span class="filename">PetDto.scala</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="k">package</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">pet</span><span class="p">.</span><span class="n">dto</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="k">sealed</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="nc">PetDto</span><span class="w"> </span><span class="c1">// An ADT</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="k">object</span><span class="w"> </span><span class="nc">PetDto</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Dog</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">)</span><span class="w">  </span><span class="k">extends</span><span class="w"> </span><span class="nc">PetDto</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Cat</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">)</span><span class="w">  </span><span class="k">extends</span><span class="w"> </span><span class="nc">PetDto</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Fish</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">)</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">PetDto</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Bird</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">)</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">PetDto</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-scala highlight"><span class="filename">PetSvc.scala</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="k">package</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="n">pet</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="nc">IO</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">pet</span><span class="p">.</span><span class="nn">dto</span><span class="p">.</span><span class="nc">PetDto</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">pet</span><span class="p">.</span><span class="nn">dto</span><span class="p">.</span><span class="nc">PetDto</span><span class="p">.</span><span class="nc">Dog</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="k">import</span><span class="w"> </span><span class="nn">shared</span><span class="p">.</span><span class="nc">BackendException</span><span class="p">.</span><span class="nc">BadRequestException</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="k">object</span><span class="w"> </span><span class="nc">PetSvc</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">petContest</span><span class="p">(</span><span class="n">dto</span><span class="p">:</span><span class="w"> </span><span class="nc">Vector</span><span class="p">[</span><span class="nc">PetDto</span><span class="p">]):</span><span class="w"> </span><span class="nc">IO</span><span class="p">[</span><span class="nc">PetDto</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="w">    </span><span class="n">_</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">raiseUnless</span><span class="p">(</span><span class="n">dto</span><span class="p">.</span><span class="n">nonEmpty</span><span class="p">)(</span><span class="nc">BadRequestException</span><span class="p">(</span><span class="s">&quot;Where are the pets ?! 😡&quot;</span><span class="p">))</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="w">    </span><span class="n">pets</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">sortWith</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="w">                </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">pet0</span><span class="p">:</span><span class="w"> </span><span class="nc">Dog</span><span class="p">,</span><span class="w"> </span><span class="n">pet1</span><span class="p">:</span><span class="w"> </span><span class="nc">Dog</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">pet0</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pet1</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="c1">// Sort before the younger dog</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="w">                </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">_:</span><span class="w"> </span><span class="nc">Dog</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">)</span><span class="w">            </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">true</span><span class="w">                </span><span class="c1">// Sort before the dog</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="w">                </span><span class="k">case</span><span class="w"> </span><span class="n">_</span><span class="w">                      </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="w">              </span><span class="p">}</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="w">    </span><span class="n">bestPet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pets</span><span class="p">.</span><span class="n">head</span>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="n">bestPet</span>
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a><span class="p">}</span>
</span></code></pre></div>
<p>Secondly, the most crucial part, but just 3 lines of code! 🤣 <strong>The switch import and the two additional implicits</strong>.</p>
<div class="language-scala highlight"><span class="filename">Serializers.scala</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="k">package</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="n">shared</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nc">GuestMod</span><span class="p">.</span><span class="nc">GenderEnum</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nc">GuestMod</span><span class="p">.</span><span class="nc">GenderEnum</span><span class="p">.</span><span class="nc">Gender</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">io</span><span class="p">.</span><span class="nn">circe</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="hll"><span class="k">import</span><span class="w"> </span><span class="nn">io</span><span class="p">.</span><span class="nn">circe</span><span class="p">.</span><span class="nn">generic</span><span class="p">.</span><span class="nn">extras</span><span class="p">.</span><span class="nc">AutoDerivation</span><span class="w"> </span><span class="c1">// ⚠️ Switched!</span>
</span></span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="k">import</span><span class="w"> </span><span class="nn">io</span><span class="p">.</span><span class="nn">circe</span><span class="p">.</span><span class="nn">generic</span><span class="p">.</span><span class="nn">extras</span><span class="p">.</span><span class="nc">Configuration</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nc">Schema</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">generic</span><span class="p">.{</span><span class="nc">Configuration</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nc">TapirConfiguration</span><span class="p">}</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">generic</span><span class="p">.</span><span class="nn">auto</span><span class="p">.</span><span class="nc">SchemaDerivation</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="k">object</span><span class="w"> </span><span class="nc">Serializers</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">AutoDerivation</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">SchemaDerivation</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// HERE! ✨ Auto Derivation Magic!</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="w">  </span><span class="c1">// The 2 implicits 👇</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="hll"><span class="w">  </span><span class="k">implicit</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">encDecConf</span><span class="p">:</span><span class="w"> </span><span class="nc">Configuration</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nc">Configuration</span><span class="p">.</span><span class="n">default</span><span class="p">.</span><span class="n">withDiscriminator</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">)</span>
</span></span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="hll"><span class="w">  </span><span class="k">implicit</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">schConf</span><span class="p">:</span><span class="w"> </span><span class="nc">TapirConfiguration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">TapirConfiguration</span><span class="p">.</span><span class="n">default</span><span class="p">.</span><span class="n">withDiscriminator</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">)</span>
</span></span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="w">  </span><span class="c1">// Enumeration needs to be auto derived manually with theses 3 lines 👇 (It will use enumeration actual values when (en/de)coding)</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="w">  </span><span class="k">implicit</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">genderEnc</span><span class="p">:</span><span class="w"> </span><span class="nc">Encoder</span><span class="p">[</span><span class="nc">Gender</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Encoder</span><span class="p">.</span><span class="n">encodeEnumeration</span><span class="p">(</span><span class="nc">GenderEnum</span><span class="p">)</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="w">  </span><span class="k">implicit</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">genderDec</span><span class="p">:</span><span class="w"> </span><span class="nc">Decoder</span><span class="p">[</span><span class="nc">Gender</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Decoder</span><span class="p">.</span><span class="n">decodeEnumeration</span><span class="p">(</span><span class="nc">GenderEnum</span><span class="p">)</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="w">  </span><span class="k">implicit</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">genderSch</span><span class="p">:</span><span class="w"> </span><span class="nc">Schema</span><span class="p">[</span><span class="nc">Gender</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nc">Schema</span><span class="p">.</span><span class="n">derivedEnumerationValue</span><span class="p">[</span><span class="nc">Gender</span><span class="p">]</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="p">}</span>
</span></code></pre></div>
<p>Thirdly, let's define our endpoint.</p>
<div class="language-scala highlight"><span class="filename">PetCtrl.scala</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="k">package</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="n">pet</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="nc">IO</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">pet</span><span class="p">.</span><span class="nn">dto</span><span class="p">.</span><span class="nc">PetDto</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="hll"><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">shared</span><span class="p">.</span><span class="nc">Serializers</span><span class="p">.</span><span class="n">_</span><span class="w"> </span><span class="c1">// ✨ Auto Derivation Magic + 2 implicits imported in scope! (== Make Scala sealed traits &quot;JSON ↔ Scala&quot; convertible)</span>
</span></span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nc">HttpRoutes</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="k">import</span><span class="w"> </span><span class="nn">shared</span><span class="p">.</span><span class="nc">BackendException</span><span class="p">.</span><span class="nc">BadRequestException</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">model</span><span class="p">.</span><span class="nc">StatusCode</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">json</span><span class="p">.</span><span class="nn">circe</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nc">Http4sServerInterpreter</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="k">object</span><span class="w"> </span><span class="nc">PetCtrl</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">endpoints</span><span class="p">:</span><span class="w"> </span><span class="nc">List</span><span class="p">[</span><span class="nc">AnyEndpoint</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">(</span><span class="n">petContestEpt</span><span class="p">)</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">routes</span><span class="p">:</span><span class="w"> </span><span class="nc">HttpRoutes</span><span class="p">[</span><span class="nc">IO</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">petContestRts</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">petContestEpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">endpoint</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="w">    </span><span class="p">.</span><span class="n">summary</span><span class="p">(</span><span class="s">&quot;Pet contest&quot;</span><span class="p">)</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="w">    </span><span class="p">.</span><span class="n">post</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="p">(</span><span class="s">&quot;pets&quot;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">&quot;contest&quot;</span><span class="p">)</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a><span class="hll"><span class="w">    </span><span class="p">.</span><span class="n">in</span><span class="p">(</span><span class="n">jsonBody</span><span class="p">[</span><span class="nc">Vector</span><span class="p">[</span><span class="nc">PetDto</span><span class="p">]])</span><span class="w">                                                   </span><span class="c1">// ✨ Auto Derivation Magic applied! (A sealed trait this time :O)</span>
</span></span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a><span class="hll"><span class="w">    </span><span class="p">.</span><span class="n">out</span><span class="p">(</span><span class="n">jsonBody</span><span class="p">[</span><span class="nc">PetDto</span><span class="p">])</span><span class="w">                                                          </span><span class="c1">// ✨ Auto Derivation Magic applied!</span>
</span></span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a><span class="w">    </span><span class="p">.</span><span class="n">errorOut</span><span class="p">(</span><span class="n">statusCode</span><span class="p">(</span><span class="nc">StatusCode</span><span class="p">.</span><span class="nc">BadRequest</span><span class="p">).</span><span class="n">and</span><span class="p">(</span><span class="n">jsonBody</span><span class="p">[</span><span class="nc">BadRequestException</span><span class="p">]))</span><span class="w"> </span><span class="c1">// ✨ Auto Derivation Magic applied!</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">petContestRts</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a><span class="w">    </span><span class="nc">Http4sServerInterpreter</span><span class="p">[</span><span class="nc">IO</span><span class="p">]().</span><span class="n">toRoutes</span><span class="p">(</span><span class="n">petContestEpt</span><span class="p">.</span><span class="n">serverLogicRecoverErrors</span><span class="p">(</span><span class="n">dto</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nc">PetSvc</span><span class="p">.</span><span class="n">petContest</span><span class="p">(</span><span class="n">dto</span><span class="p">)))</span>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a><span class="p">}</span>
</span></code></pre></div>
<p>Finally, you know the tune now, "🌉 ↔ ⚡".</p>
<div class="language-scala highlight"><span class="filename">BackendServerConf.scala</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="n">lovindata</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="k">package</span><span class="w"> </span><span class="n">config</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">effect</span><span class="p">.</span><span class="nc">IO</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">cats</span><span class="p">.</span><span class="nn">implicits</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">comcast</span><span class="p">.</span><span class="nn">ip4s</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">guest</span><span class="p">.</span><span class="nc">GuestCtrl</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">pet</span><span class="p">.</span><span class="nc">PetCtrl</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="k">import</span><span class="w"> </span><span class="nn">features</span><span class="p">.</span><span class="nn">text</span><span class="p">.</span><span class="nc">TextCtrl</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nn">ember</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nc">EmberServerBuilder</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nn">implicits</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="k">import</span><span class="w"> </span><span class="nn">shared</span><span class="p">.</span><span class="nc">BackendException</span><span class="p">.</span><span class="nc">ServerInternalErrorException</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nc">Http4sServerInterpreter</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">swagger</span><span class="p">.</span><span class="nn">bundle</span><span class="p">.</span><span class="nc">SwaggerInterpreter</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="k">object</span><span class="w"> </span><span class="nc">BackendServerConf</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">:</span><span class="w"> </span><span class="nc">IO</span><span class="p">[</span><span class="nc">Unit</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="w">    </span><span class="n">port</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">fromOption</span><span class="p">(</span><span class="nc">Port</span><span class="p">.</span><span class="n">fromInt</span><span class="p">(</span><span class="nc">EnvLoaderConf</span><span class="p">.</span><span class="n">backendPort</span><span class="p">))(</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="w">              </span><span class="nc">ServerInternalErrorException</span><span class="p">(</span><span class="s">s&quot;Not processable port number </span><span class="si">${</span><span class="nc">EnvLoaderConf</span><span class="p">.</span><span class="n">backendPort</span><span class="si">}</span><span class="s">.&quot;</span><span class="p">))</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="w">    </span><span class="n">_</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">EmberServerBuilder</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="w">              </span><span class="p">.</span><span class="n">default</span><span class="p">[</span><span class="nc">IO</span><span class="p">]</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a><span class="w">              </span><span class="p">.</span><span class="n">withHost</span><span class="p">(</span><span class="n">ipv4</span><span class="s">&quot;0.0.0.0&quot;</span><span class="p">)</span><span class="w">        </span><span class="c1">// Accept connections from any available network interface</span>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a><span class="w">              </span><span class="p">.</span><span class="n">withPort</span><span class="p">(</span><span class="n">port</span><span class="p">)</span><span class="w">                 </span><span class="c1">// On port 8080</span>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a><span class="w">              </span><span class="p">.</span><span class="n">withHttpApp</span><span class="p">(</span><span class="n">allRts</span><span class="p">.</span><span class="n">orNotFound</span><span class="p">)</span><span class="w"> </span><span class="c1">// Link all routes to the backend server</span>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a><span class="w">              </span><span class="p">.</span><span class="n">build</span>
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a><span class="w">              </span><span class="p">.</span><span class="n">use</span><span class="p">(</span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">never</span><span class="p">)</span>
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a><span class="w">              </span><span class="p">.</span><span class="n">start</span>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a><span class="w">              </span><span class="p">.</span><span class="n">void</span>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="p">()</span>
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a>
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">docsEpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">// Merge all endpoints as a fully usable OpenAPI doc</span>
</span><span id="__span-25-32"><a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a><span class="w">    </span><span class="nc">SwaggerInterpreter</span><span class="p">()</span>
</span><span id="__span-25-33"><a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a><span class="hll"><span class="w">      </span><span class="p">.</span><span class="n">fromEndpoints</span><span class="p">[</span><span class="nc">IO</span><span class="p">](</span><span class="nc">TextCtrl</span><span class="p">.</span><span class="n">endpoints</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="nc">GuestCtrl</span><span class="p">.</span><span class="n">endpoints</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="nc">PetCtrl</span><span class="p">.</span><span class="n">endpoints</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Backend&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span><span class="p">)</span>
</span></span><span id="__span-25-34"><a id="__codelineno-25-34" name="__codelineno-25-34" href="#__codelineno-25-34"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">allRts</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="c1">// Serve the OpenAPI doc &amp; all the other routes</span>
</span><span id="__span-25-35"><a id="__codelineno-25-35" name="__codelineno-25-35" href="#__codelineno-25-35"></a><span class="hll"><span class="w">    </span><span class="nc">Http4sServerInterpreter</span><span class="p">[</span><span class="nc">IO</span><span class="p">]().</span><span class="n">toRoutes</span><span class="p">(</span><span class="n">docsEpt</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;+&gt;</span><span class="w"> </span><span class="nc">TextCtrl</span><span class="p">.</span><span class="n">routes</span><span class="w"> </span><span class="o">&lt;+&gt;</span><span class="w"> </span><span class="nc">GuestCtrl</span><span class="p">.</span><span class="n">routes</span><span class="w"> </span><span class="o">&lt;+&gt;</span><span class="w"> </span><span class="nc">PetCtrl</span><span class="p">.</span><span class="n">routes</span>
</span></span><span id="__span-25-36"><a id="__codelineno-25-36" name="__codelineno-25-36" href="#__codelineno-25-36"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="results_1">Results</h4>
<figure>
  <a class="glightbox" href="../../../../0/image-11.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Pet contest" src="../../../../0/image-11.png" /></a>
  <figcaption>Pet contest</figcaption>
</figure>
<h2 id="happy-endings">🌟 Happy Endings!</h2>
<p>If you've made it this far, you should now be able to handle 80% of overall backend requirements 💪, specifically "friendly chat between clients and servers using JSON". I'm counting on you 🙏, and remember 🥺, there are only three concepts to keep in mind:</p>
<ul>
<li>⚡ <strong>Backend server</strong></li>
</ul>
<div class="language-scala highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">comcast</span><span class="p">.</span><span class="nn">ip4s</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nn">ember</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nc">EmberServerBuilder</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="nc">EmberServerBuilder</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">  </span><span class="p">.</span><span class="n">default</span><span class="p">[</span><span class="nc">IO</span><span class="p">]</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">  </span><span class="p">.</span><span class="n">withHost</span><span class="p">(</span><span class="n">ipv4</span><span class="s">&quot;0.0.0.0&quot;</span><span class="p">)</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">  </span><span class="p">.</span><span class="n">withPort</span><span class="p">(</span><span class="n">myPort</span><span class="p">)</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="w">  </span><span class="p">.</span><span class="n">withHttpApp</span><span class="p">(</span><span class="n">allRts</span><span class="p">.</span><span class="n">orNotFound</span><span class="p">)</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="w">  </span><span class="p">.</span><span class="n">build</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="w">  </span><span class="p">.</span><span class="n">use</span><span class="p">(</span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">never</span><span class="p">)</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="w">  </span><span class="p">.</span><span class="n">start</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="w">  </span><span class="p">.</span><span class="n">void</span>
</span></code></pre></div>
<ul>
<li>🌉 <strong>Endpoint and Route</strong></li>
</ul>
<div class="language-scala highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">model</span><span class="p">.</span><span class="nc">StatusCode</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">json</span><span class="p">.</span><span class="nn">circe</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">server</span><span class="p">.</span><span class="nn">http4s</span><span class="p">.</span><span class="nc">Http4sServerInterpreter</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">myEpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">endpoint</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">  </span><span class="p">.</span><span class="n">summary</span><span class="p">(</span><span class="s">&quot;My endpoint summary&quot;</span><span class="p">)</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">  </span><span class="p">.</span><span class="n">post</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">  </span><span class="p">.</span><span class="n">in</span><span class="p">(</span><span class="s">&quot;my-endpoint-path&quot;</span><span class="p">)</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">  </span><span class="p">.</span><span class="n">in</span><span class="p">(</span><span class="n">jsonBody</span><span class="p">[</span><span class="o">???</span><span class="p">])</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="w">  </span><span class="p">.</span><span class="n">out</span><span class="p">(</span><span class="n">jsonBody</span><span class="p">[</span><span class="o">???</span><span class="p">])</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="w">  </span><span class="p">.</span><span class="n">errorOut</span><span class="p">(</span><span class="n">statusCode</span><span class="p">(</span><span class="nc">StatusCode</span><span class="p">.</span><span class="o">???</span><span class="p">).</span><span class="n">and</span><span class="p">(</span><span class="n">jsonBody</span><span class="p">[</span><span class="o">???</span><span class="p">]))</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="k">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">myRts</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="w">  </span><span class="nc">Http4sServerInterpreter</span><span class="p">[</span><span class="nc">IO</span><span class="p">]().</span><span class="n">toRoutes</span><span class="p">(</span><span class="n">myEpt</span><span class="p">.</span><span class="n">serverLogicRecoverErrors</span><span class="p">(</span><span class="n">inputs</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">???</span><span class="p">))</span>
</span></code></pre></div>
<ul>
<li>✨ <strong>Auto Derivation Magic!</strong></li>
</ul>
<div class="language-scala highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">import</span><span class="w"> </span><span class="nn">io</span><span class="p">.</span><span class="nn">circe</span><span class="p">.</span><span class="n">_</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="k">import</span><span class="w"> </span><span class="nn">io</span><span class="p">.</span><span class="nn">circe</span><span class="p">.</span><span class="nn">generic</span><span class="p">.</span><span class="nn">extras</span><span class="p">.</span><span class="nc">AutoDerivation</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="k">import</span><span class="w"> </span><span class="nn">io</span><span class="p">.</span><span class="nn">circe</span><span class="p">.</span><span class="nn">generic</span><span class="p">.</span><span class="nn">extras</span><span class="p">.</span><span class="nc">Configuration</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nc">Schema</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">generic</span><span class="p">.{</span><span class="nc">Configuration</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nc">TapirConfiguration</span><span class="p">}</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">sttp</span><span class="p">.</span><span class="nn">tapir</span><span class="p">.</span><span class="nn">generic</span><span class="p">.</span><span class="nn">auto</span><span class="p">.</span><span class="nc">SchemaDerivation</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="k">object</span><span class="w"> </span><span class="nc">Serializers</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nc">AutoDerivation</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">SchemaDerivation</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="w">  </span><span class="k">implicit</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">encDecConf</span><span class="p">:</span><span class="w"> </span><span class="nc">Configuration</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nc">Configuration</span><span class="p">.</span><span class="n">default</span><span class="p">.</span><span class="n">withDiscriminator</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">)</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="w">  </span><span class="k">implicit</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">schConf</span><span class="p">:</span><span class="w"> </span><span class="nc">TapirConfiguration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">TapirConfiguration</span><span class="p">.</span><span class="n">default</span><span class="p">.</span><span class="n">withDiscriminator</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">)</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="w">  </span><span class="c1">// ... some other encoders, decoders and schemas that needs to be defined manually (like enums)</span>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="p">}</span>
</span></code></pre></div>
<p>The remaining 20% involves setting up security, streaming support, web sockets, server-sent events, and serving static content. You can find more information about these topics on the <a href="https://tapir.softwaremill.com/en/latest/">Tapir official docs</a>. In most cases, these only need to be set up once or may not be necessary. However, if you'd like me to cover them, please let me know! You can reach me on social media by sending a message 🤗!</p>







  
  



  


  



      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; <script>document.write(new Date().getFullYear())</script> James Jiang
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/lovindata" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/user/jamesjg/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://hub.docker.com/repositories/lovindata" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/jamesjg_" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/james-jiang-87306b155/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.reddit.com/user/lovindata/" target="_blank" rel="noopener" title="www.reddit.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://medium.com/@jamesjg" target="_blank" rel="noopener" title="medium.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262m288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tracking", "navigation.tabs", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>